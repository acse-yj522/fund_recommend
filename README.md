# 基金推荐模型设计文档



## 一、业务理解及步骤说明

- 已知：

基金数据包含：基金代码，基金公司，基金成立时间，净值以及另外30个特征

客户数据包含：客户代码，客户公司名称，客户公司编号，另外40个特征，以及该公司选择的基金代码。

- 需求：

依据上述数据，实现一个基金的推荐算法，以一个客户40个特征为输入，输出推送的第一基金、第二基金、第三基金、第四基金

- 思路

  第一步：考虑到分别提供了两份数据表：客户数据和基金数据。如何将2张表上的特征结合起来是关键。可以发现基金编号可以作为纽带，通过将客户数据中给客户推荐的基金和基金数据中该基金对应的特征（包括基金公司、上市时间、净值）相结合，所有特征都作为X训练，而目标Y则是推荐基金的排序。每个客户数据对应200支基金做分类。

  第二步：发现已知的客户数据中，有的没有基金推荐，因此先将带有推荐基金的客户数据筛选出来作为可用的训练及测试数据。而带推荐基金的客户数据则按基金的推荐顺序为每个基金标号，分别为1，2，3，4。而200支基金中，没有涉及的基金，对应的排序Y均标为0。这样通过标号的方式确保了推荐基金时的顺序。

  第三步：因为要处理的是一个多分类问题，会尝试一些分类模型如逻辑回归，随机森林，感知机模型等。

## 二、特征处理

首先，客户数据的40个特征以及基金数据的30个特征加上’净值‘，他们都属于数值型。因此采用标准化处理，即将特征重新缩放到零均值和单位方差来标准化数据。公式是每个数据减去当前列的均值再除以但前列的标准差。

因为上市时间、基金公司，它们会影响客户对基金的选择，因此考虑这类非数值型特征并对它们采用独热编码处理，但这样也会使整个特征矩阵变得稀疏。

## 三、算法选型

因为以上设计的基金推荐模型属于多分类问题，尝试了机器学习中常见的分类模型，如逻辑回归，随机森林，感知机模型等。

首先，尝试了感知机模型。其基于简单的线性分类，因此处理大规模数据集时效率很高。但正因为它是线性分类器，在处理一些非线性问题，如面对此次高维度的特征时，学习特征的效果不是很好。精度为0.92 相比其他分类模型较低。

其次，尝试了逻辑回归算法。因为逻辑回归擅长处理稀疏高维特征，而本次数据处理时对于类别型特征如’基金公司‘和’基金成立时间‘进行了one-hot编码，特征矩阵中含有大量0。逻辑回归的精度优于感知机模型，达到0.98。

接着，采用集成学习中的随机森林算法，通过500个决策树对预测的分类进行投票选择，这能够减少过拟合，同时并行处理数据可以提升计算效率。但随机森林在处理高维的稀疏数据时，效果可能不是很好。随机森林预测结果和逻辑回归一致，因此精度也是0.98。

最后还尝试了支持向量机算法。因为训练时间过长股放弃，考虑到以下原因：SVM的训练过程涉及到优化问题的求解，其中需要计算支持向量，而这可能在大规模数据集上变得贵。而随机森林和逻辑回归通常在大规模数据集上的计算效率较高。随机森林通过并行处理多个决策树，逻辑回归是一种线性模型，它们的计算相对较简单。

## 四、代码

具体代码见文件夹内的`fund_recommend.ipynb`，其中附有每步的代码说明。

文件夹内容同步至 [GitHub 仓库](https://github.com/acse-yj522/fund_recommend)

## 五、改进优化

模型虽然精度很高，因为标分类类别时，每个客户样本对应200个基金，大部分（196个以上）基金的类别都是0，剩下很少的是1，2，3，4。这样导致预测出的结果很容易出现全0的情况，这是不希望看到的。可能在权重、模型优化等方向进一步提升模型的效果。